var CHoice;!function(a){CHoice={init:function(e){a("#choiceContainer").hide(),CHoice.url=window.choice_url,CHoice.settings={blueprintItem:"<li class='accordion-item' data-accordion-item><a href='#' class='accordion-title clearfix'>{% courseName %}</a><div class='accordion-content' data-tab-content style='display: none;'><h4>Exams/Summaries</h4><table cellspacing='0'><thead><tr><th width='150px'>Course Code</th><th>Exam</th><th width='150px'>Answers</th><th width='50px'></th></tr></thead><tbody>{% content %}</tbody></table></li>",blueprintItemNoResult:"<li class='accordion-item' data-accordion-item><a href='#' class='accordion-title clearfix'>No courses found that match your search criteria.</li>",blueprintRow:"<tr><td>{% courseCode %}</td><td>{% name %}</td><td><span class='ch-{% answers %}'></span></td><td><a target='_blank' href='"+CHoice.url+"document/exam/{% documentId %}' class='button tiny'><span class='ch-file-o'></span></a></td></tr>",blueprintRowNoResult:"<tr><td colspan='4'>No exams available yet.</td></tr>"},CHoice.checkAuth(),CHoice.binds()},binds:function(){a("#searchQuery").on("keyup",CHoice._debounce(CHoice.searchCourses,250)),a("#searchStudy, #searchProgram").on("change",CHoice._debounce(CHoice.searchCourses,250))},checkAuth:function(){a.ajax({url:CHoice.url+"api/v1/authentication",success:function(e,t,o){202===o.status&&CHoice.initChoice()}})},initChoice:function(){a("#choiceContainer").show(),a("#choiceLogin").hide(),a.ajax({url:CHoice.url+"api/v1/course/active",dataType:"json",success:function(e){CHoice.handleGetCourses(e)}})},searchCourses:function(){a.ajax({url:CHoice.url+"api/v1/course/active/search",data:{study:a("#searchStudy").val(),program:a("#searchProgram").val(),query:a("#searchQuery").val()},dataType:"json",success:function(e){CHoice.handleGetCourses(e)}})},handleGetCourses:function(e){a("#choice-accordion").empty(),0<e.content.length?a.each(e.content,function(e,t){var o=t.code+" "+t.name,c=CHoice.settings.blueprintItem.split("{% courseName %}").join(o),n=CHoice.handleGetCourseExamResponse(t.exam);c=c.split("{% content %}").join(n),a("#choice-accordion").append(c)}):a("#choice-accordion").append(CHoice.settings.blueprintItemNoResult),Foundation.reInit(a("#choice-accordion"))},handleGetCourseExamResponse:function(e){var i="";return 0<e.length?a.each(e,function(e,t){var o=CHoice.settings.blueprintRow.split("{% courseCode %}").join(t.course.code),c=t.date.month.toLowerCase().replace(/\b[a-z]/g,function(e){return e.toUpperCase()}),n=t.name+" "+c+" "+t.date.dayOfMonth+", "+t.date.year;o=(o=(o=o.split("{% name %}").join(n)).split("{% documentId %}").join(t.id)).split("{% answers %}").join(t.includingAnswers?"check":"ban"),i+=o}):i=CHoice.settings.blueprintRowNoResult,i},_debounce:function(c,n,i){var a;return function(){var e=this,t=arguments,o=i&&!a;clearTimeout(a),a=setTimeout(function(){a=null,i||c.apply(e,t)},n),o&&c.apply(e,t)}}}}(jQuery);